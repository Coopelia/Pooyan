{"version":3,"sources":["game.js"],"names":["window","Global","score","number_wolf","wolfAtLadder","wolfUnderLadder","HP","cc","Class","extends","Component","properties","bulletPrefab","default","type","Prefab","wolfPrefab","player","Node","shoot_audio","AudioClip","BGM","numLabel","Label","scoreLabel","alert","gameOverMeg","timer","wolf_timer","tt","gameOver","maxIndex","spawnNewBullet","newBullet","instantiate","setPosition","getPlayerPosition","node","addChild","audioEngine","setEffectsVolume","playEffect","spawnNewWolf","newWolf","Math","random","mo_x","getComponent","pos_x","mo_y","pos_y","v2","onKeyDown","event","keyCode","macro","KEY","z","shoot","onKeyUp","onLoad","opacity","scale","playMusic","systemEvent","on","SystemEvent","EventType","KEY_DOWN","KEY_UP","onDestroy","off","numberOfWolf","string","showScore","start","director","resume","gameControl","FailedGame","setSiblingIndex","active","f","fadeTo","runAction","s","scaleTo","easing","easeBackOut","pause","update","dt","ceil"],"mappings":";;;;;;AAAAA,OAAOC,MAAP,GAAgB;AACZC,WAAO,CADK;AAEZC,iBAAa,CAFD;AAGZC,kBAAc,CAHF;AAIZC,qBAAiB,CAJL;AAKZC,QAAI;AALQ,CAAhB;;AAQAC,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,sBAAc;AACVC,qBAAS,IADC;AAEVC,kBAAMP,GAAGQ;AAFC,SADN;AAKRC,oBAAY;AACRH,qBAAS,IADD;AAERC,kBAAMP,GAAGQ;AAFD,SALJ;AASRE,gBAAQ;AACJJ,qBAAS,IADL;AAEJC,kBAAMP,GAAGW;AAFL,SATA;AAaRC,qBAAa;AACTN,qBAAS,IADA;AAETC,kBAAMP,GAAGa;AAFA,SAbL;AAiBRC,aAAK;AACDR,qBAAS,IADR;AAEDC,kBAAMP,GAAGa;AAFR,SAjBG;AAqBRE,kBAAU;AACNT,qBAAS,IADH;AAENC,kBAAMP,GAAGgB;AAFH,SArBF;AAyBRC,oBAAY;AACRX,qBAAS,IADD;AAERC,kBAAMP,GAAGgB;AAFD,SAzBJ;AA6BRE,eAAO;AACHZ,qBAAS,IADN;AAEHC,kBAAMP,GAAGW;AAFN,SA7BC;AAiCRQ,qBAAa;AACTb,qBAAS,IADA;AAETC,kBAAMP,GAAGgB;AAFA,SAjCL;AAqCRI,eAAO,CArCC;AAsCRxB,qBAAa,CAtCL;AAuCRyB,oBAAY,CAvCJ;AAwCRC,YAAI,CAxCI;AAyCRC,kBAAU,KAzCF;AA0CRC,kBAAU;AA1CF,KAHP;;AAgDLC,oBAAgB,0BAAW;AACvB,YAAIC,YAAY1B,GAAG2B,WAAH,CAAe,KAAKtB,YAApB,CAAhB;AACAqB,kBAAUE,WAAV,CAAsB,KAAKC,iBAAL,EAAtB;AACA,aAAKC,IAAL,CAAUC,QAAV,CAAmBL,SAAnB;AACA1B,WAAGgC,WAAH,CAAeC,gBAAf,CAAgC,GAAhC;AACAjC,WAAGgC,WAAH,CAAeE,UAAf,CAA0B,KAAKtB,WAA/B,EAA4C,KAA5C;AACH,KAtDI;;AAwDLuB,kBAAc,wBAAW;AACrB,YAAIC,UAAUpC,GAAG2B,WAAH,CAAe,KAAKlB,UAApB,CAAd;AACA2B,gBAAQR,WAAR,CAAoB,CAAC,GAAD,GAAOS,KAAKC,MAAL,KAAgB,GAA3C,EAAgD,GAAhD;AACA,aAAKR,IAAL,CAAUC,QAAV,CAAmBK,OAAnB;AACA1C,eAAOE,WAAP;AACA,aAAK4B,QAAL;AACH,KA9DI;;AAgELK,uBAAmB,6BAAW;AAC1B,YAAIU,OAAO,KAAK7B,MAAL,CAAY8B,YAAZ,CAAyB,gBAAzB,EAA2CC,KAAtD;AACA,YAAIC,OAAO,KAAKhC,MAAL,CAAY8B,YAAZ,CAAyB,gBAAzB,EAA2CG,KAAtD;AACA,eAAO3C,GAAG4C,EAAH,CAAML,OAAO,EAAb,EAAiBG,OAAO,EAAxB,CAAP;AACH,KApEI;;AAsELG,aAtEK,qBAsEKC,KAtEL,EAsEY;AACb,gBAAQA,MAAMC,OAAd;AACI,iBAAK/C,GAAGgD,KAAH,CAASC,GAAT,CAAaC,CAAlB;AACI,qBAAKC,KAAL,GAAa,IAAb;AACA;AAHR;AAKH,KA5EI;AA8ELC,WA9EK,mBA8EGN,KA9EH,EA8EU;AACX,gBAAQA,MAAMC,OAAd;AACI,iBAAK/C,GAAGgD,KAAH,CAASC,GAAT,CAAaC,CAAlB;AACI,qBAAKC,KAAL,GAAa,KAAb;AACA;AAHR;AAKH,KApFI;;;AAsFLE,YAAQ,kBAAW;AACf,aAAKnC,KAAL,CAAWoC,OAAX,GAAqB,CAArB;AACA,aAAKpC,KAAL,CAAWqC,KAAX,GAAmB,CAAnB;;AAEA,aAAKJ,KAAL,GAAa,KAAb;AACAnD,WAAGgC,WAAH,CAAewB,SAAf,CAAyB,KAAK1C,GAA9B,EAAmC,IAAnC;AACApB,eAAOE,WAAP,GAAqB,KAAKA,WAA1B;;AAEAI,WAAGyD,WAAH,CAAeC,EAAf,CAAkB1D,GAAG2D,WAAH,CAAeC,SAAf,CAAyBC,QAA3C,EAAqD,KAAKhB,SAA1D,EAAqE,IAArE;AACA7C,WAAGyD,WAAH,CAAeC,EAAf,CAAkB1D,GAAG2D,WAAH,CAAeC,SAAf,CAAyBE,MAA3C,EAAmD,KAAKV,OAAxD,EAAiE,IAAjE;AACH,KAhGI;;AAkGLW,aAlGK,uBAkGO;AACR/D,WAAGyD,WAAH,CAAeO,GAAf,CAAmBhE,GAAG2D,WAAH,CAAeC,SAAf,CAAyBC,QAA5C,EAAsD,KAAKhB,SAA3D,EAAsE,IAAtE;AACA7C,WAAGyD,WAAH,CAAeO,GAAf,CAAmBhE,GAAG2D,WAAH,CAAeC,SAAf,CAAyBE,MAA5C,EAAoD,KAAKV,OAAzD,EAAkE,IAAlE;AACH,KArGI;;;AAuGLa,kBAAc,wBAAW;AACrB,aAAKlD,QAAL,CAAcmD,MAAd,GAAuB,KAAKxE,OAAOE,WAAnC;AACH,KAzGI;;AA2GLuE,eAAW,qBAAW;AAClB,aAAKlD,UAAL,CAAgBiD,MAAhB,GAAyB,KAAKxE,OAAOC,KAArC;AACH,KA7GI;;AA+GLyE,SA/GK,mBA+GG;AACJpE,WAAGqE,QAAH,CAAYC,MAAZ;AACH,KAjHI;;;AAmHLC,iBAAa,uBAAW;AACpB,YAAI7E,OAAOK,EAAP,IAAa,CAAjB,EACI,KAAKwB,QAAL,GAAgB,IAAhB;AACP,KAtHI;;AAwHLiD,gBAAY,sBAAW;AACnB,aAAKtD,KAAL,CAAWuD,eAAX,CAA2B,KAAKjD,QAAL,GAAgB,CAA3C;AACA,YAAI,KAAKN,KAAL,CAAWqC,KAAX,IAAoB,CAAxB,EAA2B;AACvB,iBAAKzB,IAAL,CAAU4C,MAAV,GAAmB,IAAnB;AACA,gBAAIC,IAAI3E,GAAG4E,MAAH,CAAU,GAAV,EAAe,GAAf,CAAR;AACA,iBAAK1D,KAAL,CAAW2D,SAAX,CAAqBF,CAArB;AACA,gBAAIG,IAAI9E,GAAG+E,OAAH,CAAW,CAAX,EAAc,CAAd,EAAiBC,MAAjB,CAAwBhF,GAAGiF,WAAH,EAAxB,CAAR;AACA,iBAAK/D,KAAL,CAAW2D,SAAX,CAAqBC,CAArB;AACA,iBAAK3D,WAAL,CAAiB+C,MAAjB,GAA0B,gBAAgBxE,OAAOC,KAAjD;AACH,SAPD,MAOO,IAAI,KAAKuB,KAAL,CAAWqC,KAAX,IAAoB,CAAxB,EACHvD,GAAGqE,QAAH,CAAYa,KAAZ;AACP,KAnII;;AAqILC,YAAQ,gBAASC,EAAT,EAAa;AACjB,aAAKb,WAAL;AACA,YAAI,KAAKhD,QAAT,EACI,KAAKiD,UAAL;;AAEJ,YAAI,KAAKrB,KAAT,EAAgB;AACZ,gBAAI,KAAK/B,KAAL,GAAa,EAAb,IAAmB,CAAvB,EAA0B;AACtB,qBAAKK,cAAL;AACA,qBAAKL,KAAL,GAAa,CAAb;AACH;AACD,iBAAKA,KAAL,IAAc,CAAd;AACH,SAND,MAOI,KAAKA,KAAL,GAAa,CAAb;;AAEJ,aAAK6C,YAAL;AACA,aAAKE,SAAL;;AAEA,aAAK9C,UAAL,IAAmB,CAAnB;AACA,YAAI,KAAKA,UAAL,IAAmB,KAAK,KAAKC,EAA7B,IAAmC,KAAK1B,WAAL,IAAoB,CAA3D,EAA8D;AAC1D,iBAAKuC,YAAL;AACA,iBAAKb,EAAL,GAAUe,KAAKgD,IAAL,CAAUhD,KAAKC,MAAL,KAAgB,GAA1B,CAAV;AACA,iBAAKjB,UAAL,GAAkB,CAAlB;AACH;AACJ;AA5JI,CAAT","file":"game.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["window.Global = {\r\n    score: 0,\r\n    number_wolf: 0,\r\n    wolfAtLadder: 0,\r\n    wolfUnderLadder: 0,\r\n    HP: 100,\r\n};\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        bulletPrefab: {\r\n            default: null,\r\n            type: cc.Prefab,\r\n        },\r\n        wolfPrefab: {\r\n            default: null,\r\n            type: cc.Prefab,\r\n        },\r\n        player: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        shoot_audio: {\r\n            default: null,\r\n            type: cc.AudioClip,\r\n        },\r\n        BGM: {\r\n            default: null,\r\n            type: cc.AudioClip,\r\n        },\r\n        numLabel: {\r\n            default: null,\r\n            type: cc.Label,\r\n        },\r\n        scoreLabel: {\r\n            default: null,\r\n            type: cc.Label,\r\n        },\r\n        alert: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        gameOverMeg: {\r\n            default: null,\r\n            type: cc.Label,\r\n        },\r\n        timer: 0,\r\n        number_wolf: 0,\r\n        wolf_timer: 0,\r\n        tt: 0,\r\n        gameOver: false,\r\n        maxIndex: 10,\r\n    },\r\n\r\n    spawnNewBullet: function() {\r\n        var newBullet = cc.instantiate(this.bulletPrefab);\r\n        newBullet.setPosition(this.getPlayerPosition());\r\n        this.node.addChild(newBullet);\r\n        cc.audioEngine.setEffectsVolume(0.2);\r\n        cc.audioEngine.playEffect(this.shoot_audio, false);\r\n    },\r\n\r\n    spawnNewWolf: function() {\r\n        var newWolf = cc.instantiate(this.wolfPrefab);\r\n        newWolf.setPosition(-350 + Math.random() * 600, 350);\r\n        this.node.addChild(newWolf);\r\n        Global.number_wolf--;\r\n        this.maxIndex++;\r\n    },\r\n\r\n    getPlayerPosition: function() {\r\n        var mo_x = this.player.getComponent('control_mother').pos_x;\r\n        var mo_y = this.player.getComponent('control_mother').pos_y;\r\n        return cc.v2(mo_x - 50, mo_y - 15);\r\n    },\r\n\r\n    onKeyDown(event) {\r\n        switch (event.keyCode) {\r\n            case cc.macro.KEY.z:\r\n                this.shoot = true;\r\n                break;\r\n        }\r\n    },\r\n\r\n    onKeyUp(event) {\r\n        switch (event.keyCode) {\r\n            case cc.macro.KEY.z:\r\n                this.shoot = false;\r\n                break;\r\n        }\r\n    },\r\n\r\n    onLoad: function() {\r\n        this.alert.opacity = 0;\r\n        this.alert.scale = 0;\r\n\r\n        this.shoot = false;\r\n        cc.audioEngine.playMusic(this.BGM, true);\r\n        Global.number_wolf = this.number_wolf;\r\n\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\r\n    },\r\n\r\n    onDestroy() {\r\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\r\n    },\r\n\r\n    numberOfWolf: function() {\r\n        this.numLabel.string = \"\" + Global.number_wolf;\r\n    },\r\n\r\n    showScore: function() {\r\n        this.scoreLabel.string = \"\" + Global.score;\r\n    },\r\n\r\n    start() {\r\n        cc.director.resume();\r\n    },\r\n\r\n    gameControl: function() {\r\n        if (Global.HP <= 0)\r\n            this.gameOver = true;\r\n    },\r\n\r\n    FailedGame: function() {\r\n        this.alert.setSiblingIndex(this.maxIndex + 1);\r\n        if (this.alert.scale == 0) {\r\n            this.node.active = true;\r\n            var f = cc.fadeTo(0.3, 255);\r\n            this.alert.runAction(f);\r\n            var s = cc.scaleTo(1, 1).easing(cc.easeBackOut());\r\n            this.alert.runAction(s);\r\n            this.gameOverMeg.string = \"Your score:\" + Global.score;\r\n        } else if (this.alert.scale == 1)\r\n            cc.director.pause();\r\n    },\r\n\r\n    update: function(dt) {\r\n        this.gameControl();\r\n        if (this.gameOver)\r\n            this.FailedGame();\r\n\r\n        if (this.shoot) {\r\n            if (this.timer % 20 == 0) {\r\n                this.spawnNewBullet();\r\n                this.timer = 0;\r\n            }\r\n            this.timer += 1;\r\n        } else\r\n            this.timer = 0;\r\n\r\n        this.numberOfWolf();\r\n        this.showScore();\r\n\r\n        this.wolf_timer += 1;\r\n        if (this.wolf_timer == 10 + this.tt && this.number_wolf != 0) {\r\n            this.spawnNewWolf();\r\n            this.tt = Math.ceil(Math.random() * 100);\r\n            this.wolf_timer = 0;\r\n        }\r\n    },\r\n});"]}